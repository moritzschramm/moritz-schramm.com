<script>
function sendEmail(token) {

  document.getElementById("notification-success").style.display = "none";
  document.getElementById("notification-error").style.display   = "none";

  document.getElementById("btn-send").className = "button is-warning is-loading";

  var urlEncodedDataPairs = [];
  var data = {
    "email": document.getElementById("email").value,
    "subject": document.getElementById("subject").value,
    "message": document.getElementById("message").value,
    "g-recaptcha-response": token
  };

  for(name in data) {
    urlEncodedDataPairs.push(encodeURIComponent(name) + '=' + encodeURIComponent(data[name]));
  }

  urlEncodedData = urlEncodedDataPairs.join('&').replace(/%20/g, '+');

  post(urlEncodedData, function(ok) {

    document.getElementById("btn-send").className = "button is-warning";

    if(ok) {

        document.getElementById("email").value    = "";
        document.getElementById("subject").value  = "";
        document.getElementById("message").value  = "";
        document.getElementById("notification-success").style.display = "block";

    } else {

        document.getElementById("notification-error").style.display = "block";
    }
  });
}
</script>

<div class="columns">

  <div class="column is-2"></div>

  <div class="column is-8">

      <div class="field">
        <label class="label">{{ page.translations.email }}</label>
        <p class="control has-icons-left">
          <input id="email" class="input" type="email" name="email" placeholder="{{ page.translations.email }}">
          <span class="icon is-small is-left">
            <i class="fa fa-envelope"></i>
          </span>
        </p>
      </div>
      <div class="field">
        <label class="label">{{ page.translations.subject }}</label>
        <p class="control has-icons-left">
          <input id="subject" class="input" type="text" name="subject" placeholder="{{ page.translations.subject }}">
          <span class="icon is-small is-left">
            <i class="fa fa-pencil"></i>
          </span>
        </p>
      </div>

      <label class="label">{{ page.translations.message }}</label>
      <textarea id="message" class="textarea" placeholder="{{ page.translations.message }}" name="message" rows="5"></textarea>

      <div class="control">
        <div id="notification-success" class="notification is-success" style="margin-top:7px;display:none;">
          {{ page.translations.notification-success }}
        </div>
        <div id="notification-error" class="notification is-danger" style="margin-top:7px;display:none;">
          {{ page.translations.notification-error }}
        </div>
      </div>

      <br>
      <div class="control has-text-right">
        <button type="button" 
                id="btn-send" 
                class="button is-warning g-recaptcha" 
                data-sitekey="6LfIjlYUAAAAAGcH2Kg__ARWNk1HgUgLrFbegJlM"
                data-callback="sendEmail">
            {{ page.translations.send }}
        </button>
      </div>

  </div>

  <div class="column is-2"></div>

</div>
<script src='https://www.google.com/recaptcha/api.js'></script>
<script src='https://mail.moritz-schramm.com/lib'></script>